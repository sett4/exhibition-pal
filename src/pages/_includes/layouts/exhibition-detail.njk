{% extends "layouts/exhibitions.njk" %}
{% from "../components/exhibitions-hero.njk" import exhibitionsHero %}
{% from "../components/exhibition-highlights.njk" import exhibitionHighlights %}
{% from "../components/page-footer-cta.njk" import pageFooterCta %}

{% block page_title %}{{ exhibition.title }}{% endblock %}
{% block meta_description %}{{ exhibition.summary }}{% endblock %}

{% block hero %}
    {{ exhibitionsHero(exhibition, heroMedia, exhibition.title, exhibition.summary, "detail") }}
{% endblock %}

{% block content %}
  <div class="flex flex-col gap-16">
    {% if exhibition.galleryImages and exhibition.galleryImages | length > 0 %}
      <section
        aria-label="展示ギャラリー"
        class="grid gap-6 sm:grid-cols-2"
        data-testid="exhibition-gallery"
      >
        {% for image in exhibition.galleryImages %}
          <figure class="overflow-hidden rounded-3xl shadow-card">
            <img
              src="{{ image }}"
              alt="{{ exhibition.title }} ギャラリー {{ loop.index }}"
              class="h-full w-full object-cover"
              loading="lazy"
              data-testid="gallery-image"
            />
          </figure>
        {% endfor %}
      </section>
    {% endif %}

    {% for section in sections %}
      {% if section.slug == 'highlights' %}
                {{ exhibitionHighlights(section) }}
      {% else %}
        <section class="flex flex-col gap-6" data-testid="exhibition-section" data-section-slug="{{ section.slug }}">
          <div class="flex items-center gap-3">
            {# <span class="badge-outline">SECTION {{ loop.index }}</span> #}
            <h2 class="text-2xl font-bold md:text-3xl">{{ section.title }}</h2>
          </div>
          {% if section.body %}
            <p class="text-lg leading-relaxed text-neutral-700">
              {{ section.body | safe }}
            </p>
          {% endif %}
          {% if section.items and section.items | length > 0 %}
            <div class="grid gap-6 md:grid-cols-6" data-testid="section-item">
              {% for item in section.items %}
                {% if item.type == 'resource' %}
                  <a
                    class="group flex items-center justify-between rounded-2xl border border-neutral-200 bg-white p-6 shadow-card transition hover:border-brand hover:shadow-lg"
                    href="{{ item.url }}"
                    target="_blank"
                    rel="noreferrer"
                  >
                    <span class="text-lg font-semibold text-neutral-900">{{ item.label }}</span>
                    <span aria-hidden="true" class="text-brand">→</span>
                  </a>
                {% else %}
                  <article class="rounded-2xl bg-white p-6 shadow-card">
                    <h3 class="text-xl font-semibold text-neutral-900">{{ item.heading }}</h3>
                    {% if item.description %}
                      <p class="mt-3 text-neutral-600">{{ item.description }}</p>
                    {% endif %}
                  </article>
                {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </section>
      {% endif %}
    {% endfor %}

        {# {{ pageFooterCta(exhibition) }} #}
  </div>
{% endblock %}
